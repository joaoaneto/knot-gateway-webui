<div>
  <div class="alert alert-danger" ng-show="$api.$invalid" ng-messages="$api.$error" role="alert">
    <p ng-message="unexpected">An unexpected error occurred. Try again later or check your configuration.</p>
  </div>

  <uib-progressbar value="0"></uib-progressbar>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Step 1. Cloud service</h3>
    </div>
    <div class="panel-body">
      <p>Select your cloud platform</p>
      <div class="cloud-grid">
        <div class="cloud-grid-item" ng-repeat="cloud in cloudPlatforms">
          <a href ng-click="selectPlatform(cloud.name)">
            <div class="cloud" ng-class="{'selected': cloud.selected}">
              <img ng-src={{cloud.src}} width=100% alt="{{cloud.name}}">
            </div>
          </a>
        </div>
      </div>
      <p ng-hide="!form.platform">Set the KNoT Cloud server address that this gateway will connect to. This is the server where your device data and user credentials will be stored.</p>
      <br>
      <form ng-hide="!form.platform" name="cloudForm" class="form-horizontal" novalidate>
        <div ng-if="form.platform === 'MESHBLU'">
          <div class="form-group ng-class:{ 'has-error': cloudForm.hostname.$invalid && !cloudForm.hostname.$pristine }">
            <label for="hostname" class="col-sm-2 col-sm-offset-2 control-label">Hostname</label>
            <div class="col-sm-6">
              <input type="text" id="hostname" name="hostname" class="form-control" placeholder="knot-test.cesar.org.br" ng-model="form.hostname" ng-disabled="$api.$pending" hostname required>
            </div>
          </div>

          <div class="form-group ng-class:{ 'has-error': cloudForm.port.$invalid && !cloudForm.port.$pristine }">
            <label for="port" class="col-sm-2 col-sm-offset-2 control-label">Port</label>
            <div class="col-sm-6">
              <input type="number" id="port" name="port" class="form-control" placeholder="3000" ng-model="form.port" ng-disabled="$api.$pending" min="0" max="65535" required>
            </div>
          </div>

        </div>
        <div ng-if="form.platform === 'FIWARE'">
          <p class="text-center">IoT Agent configuration</p>
          <div class="form-group ng-class:{ 'has-error': cloudForm.iota.hostname.$invalid && !cloudForm.iota.hostname.$pristine }">
            <label for="hostname" class="col-sm-2 col-sm-offset-2 control-label">Hostname</label>
            <div class="col-sm-6">
              <input type="text" id="hostname-iota" name="hostname-iota" class="form-control" placeholder="knot-test.cesar.org.br" ng-model="form.iota.hostname" ng-disabled="$api.$pending" hostname required>
            </div>
          </div>

          <div class="form-group ng-class:{ 'has-error': cloudForm.iota.port.$invalid && !cloudForm.iota.port.$pristine }">
            <label for="port" class="col-sm-2 col-sm-offset-2 control-label">Port</label>
            <div class="col-sm-6">
              <input type="number" id="port-iota" name="port-iota" class="form-control" placeholder="4041" ng-model="form.iota.port" ng-disabled="$api.$pending" min="0" max="65535" required>
            </div>
          </div>

          <hr>
          <p class="text-center">Orion configuration</p>

          <div class="form-group ng-class:{ 'has-error': cloudForm.orion.hostname.$invalid && !cloudForm.orion.hostname.$pristine }">
            <label for="hostname" class="col-sm-2 col-sm-offset-2 control-label">Hostname</label>
            <div class="col-sm-6">
              <input type="text" id="hostname-orion" name="hostname-orion" class="form-control" placeholder="knot-test.cesar.org.br" ng-model="form.orion.hostname" ng-disabled="$api.$pending" hostname required>
            </div>
          </div>

          <div class="form-group ng-class:{ 'has-error': cloudForm.orion.port.$invalid && !cloudForm.orion.port.$pristine }">
            <label for="port" class="col-sm-2 col-sm-offset-2 control-label">Port</label>
            <div class="col-sm-6">
              <input type="number" id="port-orion" name="port-orion" class="form-control" placeholder="1026" ng-model="form.orion.port" ng-disabled="$api.$pending" min="0" max="65535" required>
            </div>
          </div>
          <div class="checkbox col-sm-offset-3">
            <label><input type="checkbox" ng-model="form.securityRequired">Check this option if you want to setup FIWARE security components</label>
          </div>
          <div ng-if="form.securityRequired">
            <hr>
            <p class="text-center">KeyRock configuration</p>
            <p>Set the KeyRock Identity Manager address. This is the service that will protect your FIWARE application.</p>
            <br>
            <div class="form-group ng-class:{ 'has-error': cloudForm.idm.hostname.$invalid && !cloudForm.idm.hostname.$pristine }">
              <label for="hostname" class="col-sm-2 col-sm-offset-2 control-label">Hostname</label>
              <div class="col-sm-6">
                <input type="text" id="hostname-keyrock" name="hostname-keyrock" class="form-control" placeholder="knot-test.cesar.org.br" ng-model="form.idm.hostname" ng-disabled="$api.$pending" hostname required>
              </div>
            </div>
            <div class="form-group ng-class:{ 'has-error': cloudForm.idm.port.$invalid && !cloudForm.idm.port.$pristine }">
              <label for="port" class="col-sm-2 col-sm-offset-2 control-label">Port</label>
              <div class="col-sm-6">
                <input type="number" id="port-keyrock" name="port-keyrock" class="form-control" placeholder="5000" ng-model="form.idm.port" ng-disabled="$api.$pending" min="0" max="65535" required>
              </div>
            </div>
          </div>
<!--           <br>
          <p>Set the FIWARE application authentication parameters and authorization code. The FIWARE documentation explains how to get these parameters and generate the code:
          <a href="https://fiware-idm.readthedocs.io/en/latest/user_guide/#user-guide" target="_blank">see here</a>.</p>
          <br>
          <div class="form-group ng-class:{ 'has-error': cloudForm.idm.clientId.$invalid && !cloudForm.idm.clientId.$pristine }">
            <label for="client-id" class="col-sm-2 col-sm-offset-2 control-label">Client Id</label>
            <div class="col-sm-6">
              <input type="text" id="client-id" name="client-id" class="form-control" placeholder="c2625835-814a-44ed-a59f-d0b65b175c9f" ng-model="form.idm.clientId" ng-disabled="$api.$pending" required>
            </div>
          </div>
          <div class="form-group ng-class:{ 'has-error': cloudForm.idm.clientSecret.$invalid && !cloudForm.idm.clientSecret.$pristine }">
            <label for="client-secret" class="col-sm-2 col-sm-offset-2 control-label">Client Secret</label>
            <div class="col-sm-6">
              <input type="text" id="client-secret" name="client-secret" class="form-control" placeholder="4d9dd505-a46e-4128-9ec0-32a09b57feb1" ng-model="form.idm.clientSecret" ng-disabled="$api.$pending" required>
            </div>
          </div>
          <div class="form-group ng-class:{ 'has-error': cloudForm.idm.callbackUrl.$invalid && !cloudForm.idm.callbackUrl.$pristine }">
            <label for="callback-url" class="col-sm-2 col-sm-offset-2 control-label">Callback URL</label>
            <div class="col-sm-6">
              <input type="text" id="callback-url" name="callback-url" class="form-control" placeholder="https://client.example.com" ng-model="form.idm.callbackUrl" ng-disabled="$api.$pending" required>
            </div>
          </div>
          <div class="form-group ng-class:{ 'has-error': cloudForm.idm.code.$invalid && !cloudForm.idm.code.$pristine }">
            <label for="code" class="col-sm-3 col-sm-offset-1 control-label">Authorization Code</label>
            <div class="col-sm-6">
              <input type="text" id="code" name="code" class="form-control" placeholder="SplxlOBeZQQYbYS6WxSbIA" ng-model="form.idm.code" ng-disabled="$api.$pending" required>
            </div>
          </div>
   -->      </div>
      </form>

      <nav>
        <ul class="pager">
          <li class="previous ng-class:{ disabled: $api.$pending }">
            <a ui-sref="config.welcome">Previous</a>
          </li>
          <li class="next ng-class:{ disabled: cloudForm.$invalid || $api.$pending }">
            <a href api-click="save()" api-click-state="$api" api-click-busy-when="$api.$pending" ng-disabled="cloudForm.$invalid || $api.$pending">Next</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>
